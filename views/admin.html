<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
</head>
<body>
    <h1>Admin Panel</h1>

    <h2>View Complaints</h2>
    <button onclick="viewComplaints()">View Complaints</button>
    <ul id="complaints-list"></ul>

    <h2>Delete Complaint</h2>
    <form onsubmit="deleteComplaint(event)">
        <input type="number" id="delete-id" placeholder="Enter ID to delete" required />
        <button type="submit">Delete</button>
    </form>

    <h2>Update Complaint Status</h2>
    <form onsubmit="updateComplaint(event)">
        <input type="number" id="update-id" placeholder="Enter ID to update" required />
        <input type="text" id="update-status" placeholder="Enter new status" required />
        <button type="submit">Update Status</button>
    </form>

    <script>
        function viewComplaints() {
            fetch('/admin/complaints')
                .then(response => response.json())
                .then(complaints => {
                    const list = document.getElementById('complaints-list');
                    list.innerHTML = ''; // Clear the list
                    complaints.forEach(complaint => {
                        const listItem = document.createElement('li');
                        listItem.textContent = `ID: ${complaint.id}, Severity: ${complaint.severity}, Status: ${complaint.status}`;
                        list.appendChild(listItem);
                    });
                });
        }

        function deleteComplaint(event) {
            event.preventDefault();
            const id = document.getElementById('delete-id').value;

            fetch(`/admin/complaints/${id}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => alert('Failed to delete complaint'));
        }

        function updateComplaint(event) {
            event.preventDefault();
            const id = document.getElementById('update-id').value;
            const status = document.getElementById('update-status').value;

            fetch(`/admin/complaints/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ status })
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => alert('Failed to update complaint'));
        }
    </script>
</body>
</html>
